{% extends "sprout/_layouts/base" %}
{% import "sprout/_includes/sproutcp" as sproutCp %}

{% do view.registerAssetBundle("barrelstrength\\sproutbase\\web\\assetbundles\\sproutcp\\SproutCpAsset") %}

{% set title  = "Settings"|t('sprout') %}
{% set bodyClass = craft.app.request.getSegments()|slice(0, 4)|join(' ') %}
{% set fullPageForm = true %}

{% set selectedSubnavItem = craft.app.request.getSegment(2) %}
{% set selectedSidebarItem = craft.app.request.getSegment(6) %}
{% set baseUrl = 'sprout/forms/edit/'~form.id~'/settings/' %}

{% set crumbs = [
    { label: "Forms"|t('sprout'), url: cpUrl('sprout/forms') },
    { label: form.name, url: form.getCpEditUrl() }
] %}

{% block actionButton %}
    <div class="buttons">
        <div id="save-form-button" class="btngroup submit first">
            <input type="submit" class="btn submit"
                value="{{ 'Save'|t('sprout') }}">
            {% if form.id != null %}
                <div class="btn submit menubtn"></div>
                <div class="menu">
                    <ul>
                        <li>
                            <a class="formsubmit" data-redirect="{{ ('sprout/forms/edit/'~form.id)|hash }}">
                                {{ 'Save and continue editing'|t('sprout') }}
                                <span class="shortcut">âŒ˜S</span>
                            </a>
                        </li>
                    </ul>
                    <hr>
                    <ul>
                        <li><a class="formsubmit error"
                                data-action="sprout/forms/delete-form"
                                data-confirm="{{ 'Are you sure you want to delete this form?'|t('sprout') }}"
                                data-redirect="{{ 'sprout/forms'|hash }}">{{ "Delete"|t('sprout') }}</a>
                        </li>
                    </ul>
                </div>
            {% endif %}
        </div>
        {% if config.getEnableUpgradeMessages() and config.isUpgradable() %}
            {{ sproutCp.upgradeToProButton({
                url: config.getUpgradeUrl(),
                title: config.getUpgradeMessage()
            }) }}
        {% endif %}
    </div>
{% endblock %}

{% set sidebar %}

    <nav class="last">
        <ul>
            <li><a href="{{ cpUrl(baseUrl~'general') }}"
                    {% if selectedSidebarItem == 'general' %}class="sel"{% endif %}>{{ "General"|t('sprout') }}</a>
                {#            </li>#}
                {#            <li><a href="{{ cpUrl(baseUrl~'notifications') }}"#}
                {#                    {% if selectedSidebarItem == 'notifications' %}class="sel"{% endif %}>{{ "Notifications"|t('sprout') }}</a>#}
            </li>
            <li><a href="{{ cpUrl(baseUrl~'templates') }}"
                    {% if selectedSidebarItem == 'templates' %}class="sel"{% endif %}>{{ "Templates"|t('sprout') }}</a>
            </li>
            <li><a href="{{ cpUrl(baseUrl~'rules') }}"
                    {% if selectedSidebarItem == 'rules' %}class="sel"{% endif %}>{{ "Rules"|t('sprout') }}</a>
            </li>
            <li><a href="{{ cpUrl(baseUrl~'integrations') }}"
                    {% if selectedSidebarItem == 'integrations' %}class="sel"{% endif %}>{{ "Integrations"|t('sprout') }}</a>
            </li>
        </ul>
    </nav>

{% endset %}

{% do view.registerAssetBundle("barrelstrength\\sproutbase\\web\\assetbundles\\sproutcp\\SproutCpAsset") %}
{% do view.registerJs("new Craft.SproutForms.FormSettings();") %}